# 简历系统数据库设计

## 1. 设计原则

- 表前缀: `resume_*`
- 主键统一使用 `bigint` 自增
- 时间字段使用 `datetime`
- 软删除使用 `del_flag` 字段
- 公共字段: `create_by`, `update_by`, `create_time`, `update_time`, `del_flag`

## 2. ER 图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            简历系统 ER 图                                     │
└─────────────────────────────────────────────────────────────────────────────┘

resume_template ───────────────────┐
    │                             │
    │                             ▼
resume_resume ────────┐    resume_template_config
    │                 │
    │                 │
    │    ┌────────────┴────────────┐
    │    │                         │
    ▼    ▼                         ▼
resume_education  resume_work  resume_project  resume_skill  resume_cert
```

## 3. 数据表设计

### 3.1 简历主表 (resume_resume)

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | bigint | 否 | | 主键 |
| user_id | bigint | 否 | | 所属用户ID (关联 pig_auth_user) |
| title | varchar(100) | 否 | | 简历标题 |
| template_id | bigint | 否 | | 使用模板ID |
| avatar | varchar(500) | 是 | NULL | 头像URL |
| full_name | varchar(50) | 是 | NULL | 姓名 |
| gender | char(1) | 是 | NULL | 性别 0-男 1-女 |
| birth_date | date | 是 | NULL | 出生日期 |
| phone | varchar(20) | 是 | NULL | 联系电话 |
| email | varchar(100) | 是 | NULL | 邮箱 |
| location | varchar(200) | 是 | NULL | 所在城市 |
| post_code | varchar(20) | 是 | NULL | 邮编 |
| address | varchar(500) | 是 | NULL | 详细地址 |
| summary | text | 是 | NULL | 自我评价 |
| expected_position | varchar(100) | 是 | NULL | 期望职位 |
| expected_salary | varchar(50) | 是 | NULL | 期望薪资 |
| expected_city | varchar(100) | 是 | NULL | 期望城市 |
| job_nature | char(1) | 是 | NULL | 工作性质 0-全职 1-兼职 |
| earliest_entry_date | date | 是 | NULL | 最快入职日期 |
| is_default | char(1) | 否 | 0 | 是否默认简历 |
| status | char(1) | 否 | 0 | 状态 0-草稿 1-已完成 |
| view_count | int | 否 | 0 | 浏览次数 |
| create_by | varchar(64) | 否 | | 创建人 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_by | varchar(64) | 否 | | 修改人 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 修改时间 |
| del_flag | char(1) | 否 | 0 | 删除标志 |

**索引**:
- `idx_user_id` (user_id)
- `idx_status` (status)
- `idx_is_default` (is_default)

### 3.2 模板表 (resume_template)

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | bigint | 否 | | 主键 |
| name | varchar(50) | 否 | | 模板名称 |
| code | varchar(50) | 否 | | 模板编码 |
| description | varchar(255) | 是 | NULL | 模板描述 |
| thumbnail | varchar(500) | 是 | NULL | 缩略图URL |
| preview_html | longtext | 是 | NULL | 预览HTML |
| config_json | text | 是 | NULL | 模板配置JSON |
| category | varchar(50) | 是 | NULL | 模板分类 |
| sort_order | int | 否 | 0 | 排序 |
| is_active | char(1) | 否 | 1 | 是否启用 |
| create_by | varchar(64) | 否 | | 创建人 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_by | varchar(64) | 否 | | 修改人 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 修改时间 |
| del_flag | char(1) | 否 | 0 | 删除标志 |

**索引**:
- `uk_code` (code)
- `idx_is_active` (is_active)

### 3.3 教育经历表 (resume_education)

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | bigint | 否 | | 主键 |
| resume_id | bigint | 否 | | 简历ID |
| school_name | varchar(100) | 否 | | 学校名称 |
| degree | char(1) | 是 | NULL | 学历 0-高中 1-大专 2-本科 3-硕士 4-博士 |
| major | varchar(100) | 是 | NULL | 专业 |
| start_date | date | 是 | NULL | 开始日期 |
| end_date | date | 是 | NULL | 结束日期 |
| is_current | char(1) | 否 | 0 | 是否在读 |
| description | text | 是 | NULL | 在校经历/描述 |
| sort_order | int | 否 | 0 | 排序 |
| create_by | varchar(64) | 否 | | 创建人 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_by | varchar(64) | 否 | | 修改人 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 修改时间 |
| del_flag | char(1) | 否 | 0 | 删除标志 |

**索引**:
- `idx_resume_id` (resume_id)

### 3.4 工作经历表 (resume_work)

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | bigint | 否 | | 主键 |
| resume_id | bigint | 否 | | 简历ID |
| company_name | varchar(100) | 否 | | 公司名称 |
| department | varchar(100) | 是 | NULL | 部门名称 |
| position | varchar(100) | 否 | | 职位名称 |
| start_date | date | 是 | NULL | 开始日期 |
| end_date | date | 是 | NULL | 结束日期 |
| is_current | char(1) | 否 | 0 | 是否在职 |
| work_content | text | 是 | NULL | 工作内容 |
| achievements | text | 是 | NULL | 工作业绩 |
| sort_order | int | 否 | 0 | 排序 |
| create_by | varchar(64) | 否 | | 创建人 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_by | varchar(64) | 否 | | 修改人 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 修改时间 |
| del_flag | char(1) | 否 | 0 | 删除标志 |

**索引**:
- `idx_resume_id` (resume_id)

### 3.5 项目经历表 (resume_project)

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | bigint | 否 | | 主键 |
| resume_id | bigint | 否 | | 简历ID |
| project_name | varchar(100) | 否 | | 项目名称 |
| role | varchar(100) | 是 | NULL | 项目角色 |
| company_name | varchar(100) | 是 | NULL | 公司/团队名称 |
| start_date | date | 是 | NULL | 开始日期 |
| end_date | date | 是 | NULL | 结束日期 |
| project_url | varchar(500) | 是 | NULL | 项目链接 |
| description | text | 是 | NULL | 项目描述 |
| responsibilities | text | 是 | NULL | 项目职责 |
| technologies | varchar(500) | 是 | NULL | 使用技术 |
| sort_order | int | 否 | 0 | 排序 |
| create_by | varchar(64) | 否 | | 创建人 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_by | varchar(64) | 否 | | 修改人 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 修改时间 |
| del_flag | char(1) | 否 | 0 | 删除标志 |

**索引**:
- `idx_resume_id` (resume_id)

### 3.6 专业技能表 (resume_skill)

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | bigint | 否 | | 主键 |
| resume_id | bigint | 否 | | 简历ID |
| skill_name | varchar(100) | 否 | | 技能名称 |
| proficiency | char(1) | 是 | NULL | 熟练度 0-了解 1-熟悉 2-精通 |
| category | varchar(50) | 是 | NULL | 技能分类 |
| description | varchar(500) | 是 | NULL | 技能描述 |
| sort_order | int | 否 | 0 | 排序 |
| create_by | varchar(64) | 否 | | 创建人 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_by | varchar(64) | 否 | | 修改人 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 修改时间 |
| del_flag | char(1) | 否 | 0 | 删除标志 |

**索引**:
- `idx_resume_id` (resume_id)

### 3.7 证书资质表 (resume_cert)

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | bigint | 否 | | 主键 |
| resume_id | bigint | 否 | | 简历ID |
| cert_name | varchar(100) | 否 | | 证书名称 |
| issuing_agency | varchar(100) | 是 | NULL | 发证机构 |
| issue_date | date | 是 | NULL | 获得日期 |
| expiry_date | date | 是 | NULL | 有效期至 |
| cert_code | varchar(100) | 是 | NULL | 证书编号 |
| cert_url | varchar(500) | 是 | NULL | 证书图片URL |
| description | varchar(500) | 是 | NULL | 证书描述 |
| sort_order | int | 否 | 0 | 排序 |
| create_by | varchar(64) | 否 | | 创建人 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_by | varchar(64) | 否 | | 修改人 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 修改时间 |
| del_flag | char(1) | 否 | 0 | 删除标志 |

**索引**:
- `idx_resume_id` (resume_id)

### 3.8 作品集表 (resume_portfolio)

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | bigint | 否 | | 主键 |
| resume_id | bigint | 否 | | 简历ID |
| title | varchar(100) | 否 | | 作品标题 |
| description | varchar(500) | 是 | NULL | 作品描述 |
| link_url | varchar(500) | 是 | NULL | 作品链接 |
| cover_image | varchar(500) | 是 | NULL | 封面图URL |
| sort_order | int | 否 | 0 | 排序 |
| create_by | varchar(64) | 否 | | 创建人 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_by | varchar(64) | 否 | | 修改人 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 修改时间 |
| del_flag | char(1) | 否 | 0 | 删除标志 |

**索引**:
- `idx_resume_id` (resume_id)

## 4. 字典数据

### 4.1 学历字典 (resume_degree)

| 编码 | 名称 |
|------|------|
| 0 | 高中 |
| 1 | 大专 |
| 2 | 本科 |
| 3 | 硕士 |
| 4 | 博士 |

### 4.2 熟练度 (resume_proficiency)

| 编码 | 名称 |
|------|------|
| 0 | 了解 |
| 1 | 熟悉 |
| 2 | 精通 |

### 4.3 简历状态 (resume_status)

| 编码 | 名称 |
|------|------|
| 0 | 草稿 |
| 1 | 已完成 |

## 5. 表关系说明

```
resume_resume (1) ─────── (N) resume_education
resume_resume (1) ─────── (N) resume_work
resume_resume (1) ─────── (N) resume_project
resume_resume (1) ─────── (N) resume_skill
resume_resume (1) ─────── (N) resume_cert
resume_resume (1) ─────── (N) resume_portfolio
resume_resume (N) ─────── (1) resume_template
```

## 6. 用户数据隔离

所有简历相关表通过 `resume_id` 或 `user_id` 关联，确保：
- 用户只能查看/编辑自己的简历
- 删除用户时，级联删除其所有简历数据（软删除）
- 查询时强制添加用户ID过滤条件
